{"version":"tree-0.1","tree":{"id":"App","path":"","constructInfo":{"fqn":"aws-cdk-lib.App","version":"2.214.0"},"children":{"ContainerImageBuildIntegTest":{"id":"ContainerImageBuildIntegTest","path":"ContainerImageBuildIntegTest","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.214.0"},"children":{"VpcV2":{"id":"VpcV2","path":"ContainerImageBuildIntegTest/VpcV2","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.Vpc","version":"2.214.0","metadata":[{"natGateways":"*"}]},"children":{"Resource":{"id":"Resource","path":"ContainerImageBuildIntegTest/VpcV2/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnVPC","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::VPC","aws:cdk:cloudformation:props":{"cidrBlock":"10.0.0.0/16","enableDnsHostnames":true,"enableDnsSupport":true,"instanceTenancy":"default","tags":[{"key":"Name","value":"ContainerImageBuildIntegTest/VpcV2"}]}}},"PublicSubnet1":{"id":"PublicSubnet1","path":"ContainerImageBuildIntegTest/VpcV2/PublicSubnet1","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.PublicSubnet","version":"2.214.0","metadata":[{"availabilityZone":"*","vpcId":"*","cidrBlock":"*","mapPublicIpOnLaunch":true,"ipv6CidrBlock":"*","assignIpv6AddressOnCreation":"*"},{"availabilityZone":"*","vpcId":"*","cidrBlock":"*","mapPublicIpOnLaunch":true,"ipv6CidrBlock":"*","assignIpv6AddressOnCreation":"*"},{},{"addNatGateway":["*"]}]},"children":{"Subnet":{"id":"Subnet","path":"ContainerImageBuildIntegTest/VpcV2/PublicSubnet1/Subnet","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnet","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Subnet","aws:cdk:cloudformation:props":{"availabilityZone":{"Fn::Select":[0,{"Fn::GetAZs":""}]},"cidrBlock":"10.0.0.0/18","mapPublicIpOnLaunch":true,"tags":[{"key":"aws-cdk:subnet-name","value":"Public"},{"key":"aws-cdk:subnet-type","value":"Public"},{"key":"Name","value":"ContainerImageBuildIntegTest/VpcV2/PublicSubnet1"}],"vpcId":{"Ref":"VpcV257066EE3"}}}},"Acl":{"id":"Acl","path":"ContainerImageBuildIntegTest/VpcV2/PublicSubnet1/Acl","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.214.0","metadata":[]}},"RouteTable":{"id":"RouteTable","path":"ContainerImageBuildIntegTest/VpcV2/PublicSubnet1/RouteTable","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRouteTable","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::RouteTable","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"ContainerImageBuildIntegTest/VpcV2/PublicSubnet1"}],"vpcId":{"Ref":"VpcV257066EE3"}}}},"RouteTableAssociation":{"id":"RouteTableAssociation","path":"ContainerImageBuildIntegTest/VpcV2/PublicSubnet1/RouteTableAssociation","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SubnetRouteTableAssociation","aws:cdk:cloudformation:props":{"routeTableId":{"Ref":"VpcV2PublicSubnet1RouteTable6094F526"},"subnetId":{"Ref":"VpcV2PublicSubnet1SubnetD67FC535"}}}},"DefaultRoute":{"id":"DefaultRoute","path":"ContainerImageBuildIntegTest/VpcV2/PublicSubnet1/DefaultRoute","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRoute","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Route","aws:cdk:cloudformation:props":{"destinationCidrBlock":"0.0.0.0/0","gatewayId":{"Ref":"VpcV2IGWD1C41C9C"},"routeTableId":{"Ref":"VpcV2PublicSubnet1RouteTable6094F526"}}}},"EIP":{"id":"EIP","path":"ContainerImageBuildIntegTest/VpcV2/PublicSubnet1/EIP","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnEIP","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::EIP","aws:cdk:cloudformation:props":{"domain":"vpc","tags":[{"key":"Name","value":"ContainerImageBuildIntegTest/VpcV2/PublicSubnet1"}]}}},"NATGateway":{"id":"NATGateway","path":"ContainerImageBuildIntegTest/VpcV2/PublicSubnet1/NATGateway","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnNatGateway","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::NatGateway","aws:cdk:cloudformation:props":{"allocationId":{"Fn::GetAtt":["VpcV2PublicSubnet1EIPCB084C48","AllocationId"]},"subnetId":{"Ref":"VpcV2PublicSubnet1SubnetD67FC535"},"tags":[{"key":"Name","value":"ContainerImageBuildIntegTest/VpcV2/PublicSubnet1"}]}}}}},"PublicSubnet2":{"id":"PublicSubnet2","path":"ContainerImageBuildIntegTest/VpcV2/PublicSubnet2","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.PublicSubnet","version":"2.214.0","metadata":[{"availabilityZone":"*","vpcId":"*","cidrBlock":"*","mapPublicIpOnLaunch":true,"ipv6CidrBlock":"*","assignIpv6AddressOnCreation":"*"},{"availabilityZone":"*","vpcId":"*","cidrBlock":"*","mapPublicIpOnLaunch":true,"ipv6CidrBlock":"*","assignIpv6AddressOnCreation":"*"},{}]},"children":{"Subnet":{"id":"Subnet","path":"ContainerImageBuildIntegTest/VpcV2/PublicSubnet2/Subnet","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnet","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Subnet","aws:cdk:cloudformation:props":{"availabilityZone":{"Fn::Select":[1,{"Fn::GetAZs":""}]},"cidrBlock":"10.0.64.0/18","mapPublicIpOnLaunch":true,"tags":[{"key":"aws-cdk:subnet-name","value":"Public"},{"key":"aws-cdk:subnet-type","value":"Public"},{"key":"Name","value":"ContainerImageBuildIntegTest/VpcV2/PublicSubnet2"}],"vpcId":{"Ref":"VpcV257066EE3"}}}},"Acl":{"id":"Acl","path":"ContainerImageBuildIntegTest/VpcV2/PublicSubnet2/Acl","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.214.0","metadata":[]}},"RouteTable":{"id":"RouteTable","path":"ContainerImageBuildIntegTest/VpcV2/PublicSubnet2/RouteTable","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRouteTable","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::RouteTable","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"ContainerImageBuildIntegTest/VpcV2/PublicSubnet2"}],"vpcId":{"Ref":"VpcV257066EE3"}}}},"RouteTableAssociation":{"id":"RouteTableAssociation","path":"ContainerImageBuildIntegTest/VpcV2/PublicSubnet2/RouteTableAssociation","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SubnetRouteTableAssociation","aws:cdk:cloudformation:props":{"routeTableId":{"Ref":"VpcV2PublicSubnet2RouteTable4FB96B9F"},"subnetId":{"Ref":"VpcV2PublicSubnet2Subnet63F50919"}}}},"DefaultRoute":{"id":"DefaultRoute","path":"ContainerImageBuildIntegTest/VpcV2/PublicSubnet2/DefaultRoute","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRoute","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Route","aws:cdk:cloudformation:props":{"destinationCidrBlock":"0.0.0.0/0","gatewayId":{"Ref":"VpcV2IGWD1C41C9C"},"routeTableId":{"Ref":"VpcV2PublicSubnet2RouteTable4FB96B9F"}}}}}},"PrivateSubnet1":{"id":"PrivateSubnet1","path":"ContainerImageBuildIntegTest/VpcV2/PrivateSubnet1","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.PrivateSubnet","version":"2.214.0","metadata":[{"availabilityZone":"*","vpcId":"*","cidrBlock":"*","mapPublicIpOnLaunch":false,"ipv6CidrBlock":"*","assignIpv6AddressOnCreation":"*"},{"availabilityZone":"*","vpcId":"*","cidrBlock":"*","mapPublicIpOnLaunch":false,"ipv6CidrBlock":"*","assignIpv6AddressOnCreation":"*"},{}]},"children":{"Subnet":{"id":"Subnet","path":"ContainerImageBuildIntegTest/VpcV2/PrivateSubnet1/Subnet","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnet","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Subnet","aws:cdk:cloudformation:props":{"availabilityZone":{"Fn::Select":[0,{"Fn::GetAZs":""}]},"cidrBlock":"10.0.128.0/18","mapPublicIpOnLaunch":false,"tags":[{"key":"aws-cdk:subnet-name","value":"Private"},{"key":"aws-cdk:subnet-type","value":"Private"},{"key":"Name","value":"ContainerImageBuildIntegTest/VpcV2/PrivateSubnet1"}],"vpcId":{"Ref":"VpcV257066EE3"}}}},"Acl":{"id":"Acl","path":"ContainerImageBuildIntegTest/VpcV2/PrivateSubnet1/Acl","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.214.0","metadata":[]}},"RouteTable":{"id":"RouteTable","path":"ContainerImageBuildIntegTest/VpcV2/PrivateSubnet1/RouteTable","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRouteTable","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::RouteTable","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"ContainerImageBuildIntegTest/VpcV2/PrivateSubnet1"}],"vpcId":{"Ref":"VpcV257066EE3"}}}},"RouteTableAssociation":{"id":"RouteTableAssociation","path":"ContainerImageBuildIntegTest/VpcV2/PrivateSubnet1/RouteTableAssociation","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SubnetRouteTableAssociation","aws:cdk:cloudformation:props":{"routeTableId":{"Ref":"VpcV2PrivateSubnet1RouteTable7476B1CF"},"subnetId":{"Ref":"VpcV2PrivateSubnet1Subnet10A485FB"}}}},"DefaultRoute":{"id":"DefaultRoute","path":"ContainerImageBuildIntegTest/VpcV2/PrivateSubnet1/DefaultRoute","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRoute","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Route","aws:cdk:cloudformation:props":{"destinationCidrBlock":"0.0.0.0/0","natGatewayId":{"Ref":"VpcV2PublicSubnet1NATGatewayD04F745E"},"routeTableId":{"Ref":"VpcV2PrivateSubnet1RouteTable7476B1CF"}}}}}},"PrivateSubnet2":{"id":"PrivateSubnet2","path":"ContainerImageBuildIntegTest/VpcV2/PrivateSubnet2","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.PrivateSubnet","version":"2.214.0","metadata":[{"availabilityZone":"*","vpcId":"*","cidrBlock":"*","mapPublicIpOnLaunch":false,"ipv6CidrBlock":"*","assignIpv6AddressOnCreation":"*"},{"availabilityZone":"*","vpcId":"*","cidrBlock":"*","mapPublicIpOnLaunch":false,"ipv6CidrBlock":"*","assignIpv6AddressOnCreation":"*"},{}]},"children":{"Subnet":{"id":"Subnet","path":"ContainerImageBuildIntegTest/VpcV2/PrivateSubnet2/Subnet","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnet","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Subnet","aws:cdk:cloudformation:props":{"availabilityZone":{"Fn::Select":[1,{"Fn::GetAZs":""}]},"cidrBlock":"10.0.192.0/18","mapPublicIpOnLaunch":false,"tags":[{"key":"aws-cdk:subnet-name","value":"Private"},{"key":"aws-cdk:subnet-type","value":"Private"},{"key":"Name","value":"ContainerImageBuildIntegTest/VpcV2/PrivateSubnet2"}],"vpcId":{"Ref":"VpcV257066EE3"}}}},"Acl":{"id":"Acl","path":"ContainerImageBuildIntegTest/VpcV2/PrivateSubnet2/Acl","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.214.0","metadata":[]}},"RouteTable":{"id":"RouteTable","path":"ContainerImageBuildIntegTest/VpcV2/PrivateSubnet2/RouteTable","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRouteTable","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::RouteTable","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"ContainerImageBuildIntegTest/VpcV2/PrivateSubnet2"}],"vpcId":{"Ref":"VpcV257066EE3"}}}},"RouteTableAssociation":{"id":"RouteTableAssociation","path":"ContainerImageBuildIntegTest/VpcV2/PrivateSubnet2/RouteTableAssociation","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SubnetRouteTableAssociation","aws:cdk:cloudformation:props":{"routeTableId":{"Ref":"VpcV2PrivateSubnet2RouteTable7B419F52"},"subnetId":{"Ref":"VpcV2PrivateSubnet2Subnet038DDA50"}}}},"DefaultRoute":{"id":"DefaultRoute","path":"ContainerImageBuildIntegTest/VpcV2/PrivateSubnet2/DefaultRoute","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRoute","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Route","aws:cdk:cloudformation:props":{"destinationCidrBlock":"0.0.0.0/0","natGatewayId":{"Ref":"VpcV2PublicSubnet1NATGatewayD04F745E"},"routeTableId":{"Ref":"VpcV2PrivateSubnet2RouteTable7B419F52"}}}}}},"IGW":{"id":"IGW","path":"ContainerImageBuildIntegTest/VpcV2/IGW","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnInternetGateway","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::InternetGateway","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"ContainerImageBuildIntegTest/VpcV2"}]}}},"VPCGW":{"id":"VPCGW","path":"ContainerImageBuildIntegTest/VpcV2/VPCGW","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnVPCGatewayAttachment","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::VPCGatewayAttachment","aws:cdk:cloudformation:props":{"internetGatewayId":{"Ref":"VpcV2IGWD1C41C9C"},"vpcId":{"Ref":"VpcV257066EE3"}}}},"RestrictDefaultSecurityGroupCustomResource":{"id":"RestrictDefaultSecurityGroupCustomResource","path":"ContainerImageBuildIntegTest/VpcV2/RestrictDefaultSecurityGroupCustomResource","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.214.0","metadata":["*"]},"children":{"Default":{"id":"Default","path":"ContainerImageBuildIntegTest/VpcV2/RestrictDefaultSecurityGroupCustomResource/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.214.0"}}}}}},"Custom::VpcRestrictDefaultSGCustomResourceProvider":{"id":"Custom::VpcRestrictDefaultSGCustomResourceProvider","path":"ContainerImageBuildIntegTest/Custom::VpcRestrictDefaultSGCustomResourceProvider","constructInfo":{"fqn":"aws-cdk-lib.CustomResourceProviderBase","version":"2.214.0"},"children":{"Staging":{"id":"Staging","path":"ContainerImageBuildIntegTest/Custom::VpcRestrictDefaultSGCustomResourceProvider/Staging","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.214.0"}},"Role":{"id":"Role","path":"ContainerImageBuildIntegTest/Custom::VpcRestrictDefaultSGCustomResourceProvider/Role","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.214.0"}},"Handler":{"id":"Handler","path":"ContainerImageBuildIntegTest/Custom::VpcRestrictDefaultSGCustomResourceProvider/Handler","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.214.0"}}}},"Build":{"id":"Build","path":"ContainerImageBuildIntegTest/Build","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"CustomResourceHandler":{"id":"CustomResourceHandler","path":"ContainerImageBuildIntegTest/Build/CustomResourceHandler","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.SingletonFunction","version":"2.214.0","metadata":[{"runtime":"*","code":"*","handler":"*","uuid":"*","lambdaPurpose":"*","timeout":"*"}]}},"Repository":{"id":"Repository","path":"ContainerImageBuildIntegTest/Build/Repository","constructInfo":{"fqn":"aws-cdk-lib.aws_ecr.Repository","version":"2.214.0","metadata":[{"removalPolicy":"destroy"},{"addToResourcePolicy":[{}]}]},"children":{"Resource":{"id":"Resource","path":"ContainerImageBuildIntegTest/Build/Repository/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ecr.CfnRepository","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ECR::Repository","aws:cdk:cloudformation:props":{"repositoryPolicyText":{"Statement":[{"Action":["ecr:BatchCheckLayerAvailability","ecr:BatchGetImage","ecr:GetDownloadUrlForLayer"],"Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"}}}}}},"Project":{"id":"Project","path":"ContainerImageBuildIntegTest/Build/Project","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}},"Source":{"id":"Source","path":"ContainerImageBuildIntegTest/Build/Source","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.214.0"},"children":{"Stage":{"id":"Stage","path":"ContainerImageBuildIntegTest/Build/Source/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.214.0"}},"AssetBucket":{"id":"AssetBucket","path":"ContainerImageBuildIntegTest/Build/Source/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.214.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"ContainerImageBuildIntegTest/Build/Resource","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.214.0","metadata":["*","*","*"]},"children":{"Default":{"id":"Default","path":"ContainerImageBuildIntegTest/Build/Resource/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.214.0"}}}}}},"DeployTimeBuildCustomResourceHandlerdb740fd554364a848a09e6dfcd01f4f3":{"id":"DeployTimeBuildCustomResourceHandlerdb740fd554364a848a09e6dfcd01f4f3","path":"ContainerImageBuildIntegTest/DeployTimeBuildCustomResourceHandlerdb740fd554364a848a09e6dfcd01f4f3","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.214.0","metadata":[{"runtime":"*","code":"*","handler":"*","timeout":"*"}]},"children":{"ServiceRole":{"id":"ServiceRole","path":"ContainerImageBuildIntegTest/DeployTimeBuildCustomResourceHandlerdb740fd554364a848a09e6dfcd01f4f3/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.214.0","metadata":[{"assumedBy":{"principalAccount":"*","assumeRoleAction":"*"},"managedPolicies":[{"managedPolicyArn":"*"}]},{"addToPrincipalPolicy":[{}]},{"attachInlinePolicy":["*"]},{"attachInlinePolicy":["*"]},{"addToPrincipalPolicy":[{}]},{"addToPrincipalPolicy":[{}]}]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"ContainerImageBuildIntegTest/DeployTimeBuildCustomResourceHandlerdb740fd554364a848a09e6dfcd01f4f3/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.214.0","metadata":["*"]}},"Resource":{"id":"Resource","path":"ContainerImageBuildIntegTest/DeployTimeBuildCustomResourceHandlerdb740fd554364a848a09e6dfcd01f4f3/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"ContainerImageBuildIntegTest/DeployTimeBuildCustomResourceHandlerdb740fd554364a848a09e6dfcd01f4f3/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.214.0","metadata":["*",{"attachToRole":["*"]},{"attachToRole":["*"]},{"addStatements":[{}]},{"addStatements":[{}]},{"addStatements":[{}]}]},"children":{"Resource":{"id":"Resource","path":"ContainerImageBuildIntegTest/DeployTimeBuildCustomResourceHandlerdb740fd554364a848a09e6dfcd01f4f3/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":"codebuild:StartBuild","Effect":"Allow","Resource":[{"Fn::GetAtt":["ContainerImageBuildAmd64e83729feb1564e709bec452b15847a30amd6491AAA9B2","Arn"]},{"Fn::GetAtt":["ContainerImageBuildAmd64e83729feb1564e709bec452b15847a30c8a085f75ccbc05f5149859bcf147b49eadd8ac37damd64C6D1C187","Arn"]},{"Fn::GetAtt":["ContainerImageBuildArm64e83729feb1564e709bec452b15847a30amd64C13E3549","Arn"]}]}],"Version":"2012-10-17"},"policyName":"DeployTimeBuildCustomResourceHandlerdb740fd554364a848a09e6dfcd01f4f3ServiceRoleDefaultPolicyFECC51DC","roles":[{"Ref":"DeployTimeBuildCustomResourceHandlerdb740fd554364a848a09e6dfcd01f4f3ServiceRoleB008BAA4"}]}}}}}}},"Code":{"id":"Code","path":"ContainerImageBuildIntegTest/DeployTimeBuildCustomResourceHandlerdb740fd554364a848a09e6dfcd01f4f3/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.214.0"},"children":{"Stage":{"id":"Stage","path":"ContainerImageBuildIntegTest/DeployTimeBuildCustomResourceHandlerdb740fd554364a848a09e6dfcd01f4f3/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.214.0"}},"AssetBucket":{"id":"AssetBucket","path":"ContainerImageBuildIntegTest/DeployTimeBuildCustomResourceHandlerdb740fd554364a848a09e6dfcd01f4f3/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.214.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"ContainerImageBuildIntegTest/DeployTimeBuildCustomResourceHandlerdb740fd554364a848a09e6dfcd01f4f3/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":{"Fn::Sub":"cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"},"s3Key":"3d2b597cfd72418177a48b4bc7ad4341e7ab73e2a1ad1bb450658ee960cbefcf.zip"},"handler":"index.handler","role":{"Fn::GetAtt":["DeployTimeBuildCustomResourceHandlerdb740fd554364a848a09e6dfcd01f4f3ServiceRoleB008BAA4","Arn"]},"runtime":"nodejs22.x","timeout":300}}},"LogGroup":{"id":"LogGroup","path":"ContainerImageBuildIntegTest/DeployTimeBuildCustomResourceHandlerdb740fd554364a848a09e6dfcd01f4f3/LogGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogGroup","version":"2.214.0","metadata":[{"logGroupName":"*"}]},"children":{"Resource":{"id":"Resource","path":"ContainerImageBuildIntegTest/DeployTimeBuildCustomResourceHandlerdb740fd554364a848a09e6dfcd01f4f3/LogGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnLogGroup","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::LogGroup","aws:cdk:cloudformation:props":{"logGroupName":{"Fn::Join":["",["/aws/lambda/",{"Ref":"DeployTimeBuildCustomResourceHandlerdb740fd554364a848a09e6dfcd01f4f306AEFF37"}]]},"retentionInDays":731}}}}}}},"ContainerImageBuildAmd64e83729feb1564e709bec452b15847a30amd64":{"id":"ContainerImageBuildAmd64e83729feb1564e709bec452b15847a30amd64","path":"ContainerImageBuildIntegTest/ContainerImageBuildAmd64e83729feb1564e709bec452b15847a30amd64","constructInfo":{"fqn":"aws-cdk-lib.aws_codebuild.Project","version":"2.214.0","metadata":[{"environment":{"computeType":"BUILD_GENERAL1_SMALL","buildImage":{"type":"*","defaultComputeType":"BUILD_GENERAL1_SMALL","imageId":"*","imagePullPrincipalType":"CODEBUILD","secretsManagerCredentials":"*","repository":"*"},"privileged":true},"vpc":"*","buildSpec":"*"}]},"children":{"Role":{"id":"Role","path":"ContainerImageBuildIntegTest/ContainerImageBuildAmd64e83729feb1564e709bec452b15847a30amd64/Role","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.214.0","metadata":[{"roleName":"*","assumedBy":{"principalAccount":"*","assumeRoleAction":"*"}},{"addToPrincipalPolicy":[{}]},{"attachInlinePolicy":["*"]},{"attachInlinePolicy":["*"]},{"addToPrincipalPolicy":[{}]},{"addManagedPolicy":[{"managedPolicyArn":"*"}]},{"addToPrincipalPolicy":[{}]},{"addToPrincipalPolicy":[{}]},{"addToPrincipalPolicy":[{}]},{"addToPrincipalPolicy":[{}]}]},"children":{"ImportRole":{"id":"ImportRole","path":"ContainerImageBuildIntegTest/ContainerImageBuildAmd64e83729feb1564e709bec452b15847a30amd64/Role/ImportRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.214.0","metadata":["*"]}},"Resource":{"id":"Resource","path":"ContainerImageBuildIntegTest/ContainerImageBuildAmd64e83729feb1564e709bec452b15847a30amd64/Role/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"codebuild.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/AmazonElasticContainerRegistryPublicReadOnly"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"ContainerImageBuildIntegTest/ContainerImageBuildAmd64e83729feb1564e709bec452b15847a30amd64/Role/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.214.0","metadata":["*",{"attachToRole":["*"]},{"attachToRole":["*"]},{"addStatements":[{}]},{"addStatements":[{}]},{"addStatements":[{}]},{"addStatements":[{}]},{"addStatements":[{}]},{"addStatements":[{}]}]},"children":{"Resource":{"id":"Resource","path":"ContainerImageBuildIntegTest/ContainerImageBuildAmd64e83729feb1564e709bec452b15847a30amd64/Role/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["logs:CreateLogGroup","logs:CreateLogStream","logs:PutLogEvents"],"Effect":"Allow","Resource":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":logs:",{"Ref":"AWS::Region"},":",{"Ref":"AWS::AccountId"},":log-group:/aws/codebuild/",{"Ref":"ContainerImageBuildAmd64e83729feb1564e709bec452b15847a30amd6491AAA9B2"},":*"]]},{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":logs:",{"Ref":"AWS::Region"},":",{"Ref":"AWS::AccountId"},":log-group:/aws/codebuild/",{"Ref":"ContainerImageBuildAmd64e83729feb1564e709bec452b15847a30amd6491AAA9B2"}]]}]},{"Action":["codebuild:BatchPutCodeCoverages","codebuild:BatchPutTestCases","codebuild:CreateReport","codebuild:CreateReportGroup","codebuild:UpdateReport"],"Effect":"Allow","Resource":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":codebuild:",{"Ref":"AWS::Region"},":",{"Ref":"AWS::AccountId"},":report-group/",{"Ref":"ContainerImageBuildAmd64e83729feb1564e709bec452b15847a30amd6491AAA9B2"},"-*"]]}},{"Action":["ecr:BatchCheckLayerAvailability","ecr:BatchGetImage","ecr:CompleteLayerUpload","ecr:DescribeImages","ecr:GetDownloadUrlForLayer","ecr:InitiateLayerUpload","ecr:PutImage","ecr:UploadLayerPart"],"Effect":"Allow","Resource":{"Fn::GetAtt":["BuildRepository4E6D17C2","Arn"]}},{"Action":"ecr:GetAuthorizationToken","Effect":"Allow","Resource":"*"},{"Action":["s3:GetBucket*","s3:GetObject*","s3:List*"],"Effect":"Allow","Resource":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":s3:::",{"Fn::Sub":"cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"},"/*"]]},{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":s3:::",{"Fn::Sub":"cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"}]]}]}],"Version":"2012-10-17"},"policyName":"ContainerImageBuildAmd64e83729feb1564e709bec452b15847a30amd64RoleDefaultPolicyBD233B55","roles":[{"Ref":"ContainerImageBuildAmd64e83729feb1564e709bec452b15847a30amd64RoleD95F32B9"}]}}}}}}},"Resource":{"id":"Resource","path":"ContainerImageBuildIntegTest/ContainerImageBuildAmd64e83729feb1564e709bec452b15847a30amd64/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_codebuild.CfnProject","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CodeBuild::Project","aws:cdk:cloudformation:props":{"artifacts":{"type":"NO_ARTIFACTS"},"cache":{"type":"NO_CACHE"},"encryptionKey":"alias/aws/s3","environment":{"type":"LINUX_CONTAINER","image":"aws/codebuild/standard:7.0","imagePullCredentialsType":"CODEBUILD","privilegedMode":true,"computeType":"BUILD_GENERAL1_SMALL"},"serviceRole":{"Fn::GetAtt":["ContainerImageBuildAmd64e83729feb1564e709bec452b15847a30amd64RoleD95F32B9","Arn"]},"source":{"type":"NO_SOURCE","buildSpec":"{\n  \"version\": \"0.2\",\n  \"phases\": {\n    \"build\": {\n      \"commands\": [\n        \"current_dir=$(pwd)\",\n        \"echo \\\"$input\\\"\",\n        \"mkdir workdir\",\n        \"cd workdir\",\n        \"aws s3 cp \\\"$sourceS3Url\\\" temp.zip\",\n        \"unzip temp.zip\",\n        \"ls -la\",\n        \"aws ecr get-login-password --region $repositoryRegion | docker login --username AWS --password-stdin $repositoryAuthUri\",\n        \"aws ecr-public get-login-password --region us-east-1 | docker login --username AWS --password-stdin public.ecr.aws\",\n        \"docker buildx ls\",\n        \"echo \\\"$buildCommand\\\"\",\n        \"eval \\\"$buildCommand\\\"\",\n        \"docker images\",\n        \"docker tag artifact:$imageTag $repositoryUri:$imageTag\",\n        \"docker push $repositoryUri:$imageTag\"\n      ]\n    },\n    \"post_build\": {\n      \"commands\": [\n        \"echo Build completed on `date`\",\n        \"\\nSTATUS='SUCCESS'\\nif [ $CODEBUILD_BUILD_SUCCEEDING -ne 1 ] # Test if the build is failing\\nthen\\nSTATUS='FAILED'\\nREASON=\\\"ContainerImageBuild failed. See CloudWatch Log stream for the detailed reason: \\nhttps://$AWS_REGION.console.aws.amazon.com/cloudwatch/home?region=$AWS_REGION#logsV2:log-groups/log-group/\\\\$252Faws\\\\$252Fcodebuild\\\\$252F$projectName/log-events/$CODEBUILD_LOG_PATH\\\"\\nfi\\ncat <<EOF > payload.json\\n{\\n  \\\"StackId\\\": \\\"$stackId\\\",\\n  \\\"RequestId\\\": \\\"$requestId\\\",\\n  \\\"LogicalResourceId\\\":\\\"$logicalResourceId\\\",\\n  \\\"PhysicalResourceId\\\": \\\"$imageTag\\\",\\n  \\\"Status\\\": \\\"$STATUS\\\",\\n  \\\"Reason\\\": \\\"$REASON\\\",\\n  \\\"Data\\\": {\\n    \\\"ImageTag\\\": \\\"$imageTag\\\"\\n  }\\n}\\nEOF\\ncurl -i -X PUT -H 'Content-Type:' -d \\\"@payload.json\\\" \\\"$responseURL\\\"\\n              \"\n      ]\n    }\n  }\n}"}}}}}},"BuildArm":{"id":"BuildArm","path":"ContainerImageBuildIntegTest/BuildArm","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"CustomResourceHandler":{"id":"CustomResourceHandler","path":"ContainerImageBuildIntegTest/BuildArm/CustomResourceHandler","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.SingletonFunction","version":"2.214.0","metadata":[{"runtime":"*","code":"*","handler":"*","uuid":"*","lambdaPurpose":"*","timeout":"*"}]}},"Project":{"id":"Project","path":"ContainerImageBuildIntegTest/BuildArm/Project","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}},"Source":{"id":"Source","path":"ContainerImageBuildIntegTest/BuildArm/Source","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.214.0"},"children":{"Stage":{"id":"Stage","path":"ContainerImageBuildIntegTest/BuildArm/Source/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.214.0"}},"AssetBucket":{"id":"AssetBucket","path":"ContainerImageBuildIntegTest/BuildArm/Source/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.214.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"ContainerImageBuildIntegTest/BuildArm/Resource","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.214.0","metadata":["*","*","*"]},"children":{"Default":{"id":"Default","path":"ContainerImageBuildIntegTest/BuildArm/Resource/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.214.0"}}}}}},"ContainerImageBuildArm64e83729feb1564e709bec452b15847a30amd64":{"id":"ContainerImageBuildArm64e83729feb1564e709bec452b15847a30amd64","path":"ContainerImageBuildIntegTest/ContainerImageBuildArm64e83729feb1564e709bec452b15847a30amd64","constructInfo":{"fqn":"aws-cdk-lib.aws_codebuild.Project","version":"2.214.0","metadata":[{"environment":{"computeType":"BUILD_GENERAL1_SMALL","buildImage":{"type":"*","defaultComputeType":"BUILD_GENERAL1_LARGE","imageId":"*","imagePullPrincipalType":"CODEBUILD","secretsManagerCredentials":"*","repository":"*"},"privileged":true},"vpc":"*","buildSpec":"*"}]},"children":{"Role":{"id":"Role","path":"ContainerImageBuildIntegTest/ContainerImageBuildArm64e83729feb1564e709bec452b15847a30amd64/Role","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.214.0","metadata":[{"roleName":"*","assumedBy":{"principalAccount":"*","assumeRoleAction":"*"}},{"addToPrincipalPolicy":[{}]},{"attachInlinePolicy":["*"]},{"attachInlinePolicy":["*"]},{"addToPrincipalPolicy":[{}]},{"addManagedPolicy":[{"managedPolicyArn":"*"}]},{"addToPrincipalPolicy":[{}]},{"addToPrincipalPolicy":[{}]},{"addToPrincipalPolicy":[{}]},{"addToPrincipalPolicy":[{}]}]},"children":{"ImportRole":{"id":"ImportRole","path":"ContainerImageBuildIntegTest/ContainerImageBuildArm64e83729feb1564e709bec452b15847a30amd64/Role/ImportRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.214.0","metadata":["*"]}},"Resource":{"id":"Resource","path":"ContainerImageBuildIntegTest/ContainerImageBuildArm64e83729feb1564e709bec452b15847a30amd64/Role/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"codebuild.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/AmazonElasticContainerRegistryPublicReadOnly"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"ContainerImageBuildIntegTest/ContainerImageBuildArm64e83729feb1564e709bec452b15847a30amd64/Role/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.214.0","metadata":["*",{"attachToRole":["*"]},{"attachToRole":["*"]},{"addStatements":[{}]},{"addStatements":[{}]},{"addStatements":[{}]},{"addStatements":[{}]},{"addStatements":[{}]},{"addStatements":[{}]}]},"children":{"Resource":{"id":"Resource","path":"ContainerImageBuildIntegTest/ContainerImageBuildArm64e83729feb1564e709bec452b15847a30amd64/Role/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["logs:CreateLogGroup","logs:CreateLogStream","logs:PutLogEvents"],"Effect":"Allow","Resource":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":logs:",{"Ref":"AWS::Region"},":",{"Ref":"AWS::AccountId"},":log-group:/aws/codebuild/",{"Ref":"ContainerImageBuildArm64e83729feb1564e709bec452b15847a30amd64C13E3549"},":*"]]},{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":logs:",{"Ref":"AWS::Region"},":",{"Ref":"AWS::AccountId"},":log-group:/aws/codebuild/",{"Ref":"ContainerImageBuildArm64e83729feb1564e709bec452b15847a30amd64C13E3549"}]]}]},{"Action":["codebuild:BatchPutCodeCoverages","codebuild:BatchPutTestCases","codebuild:CreateReport","codebuild:CreateReportGroup","codebuild:UpdateReport"],"Effect":"Allow","Resource":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":codebuild:",{"Ref":"AWS::Region"},":",{"Ref":"AWS::AccountId"},":report-group/",{"Ref":"ContainerImageBuildArm64e83729feb1564e709bec452b15847a30amd64C13E3549"},"-*"]]}},{"Action":["ecr:BatchCheckLayerAvailability","ecr:BatchGetImage","ecr:CompleteLayerUpload","ecr:DescribeImages","ecr:GetDownloadUrlForLayer","ecr:InitiateLayerUpload","ecr:PutImage","ecr:UploadLayerPart"],"Effect":"Allow","Resource":{"Fn::GetAtt":["BuildRepository4E6D17C2","Arn"]}},{"Action":"ecr:GetAuthorizationToken","Effect":"Allow","Resource":"*"},{"Action":["s3:GetBucket*","s3:GetObject*","s3:List*"],"Effect":"Allow","Resource":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":s3:::",{"Fn::Sub":"cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"},"/*"]]},{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":s3:::",{"Fn::Sub":"cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"}]]}]}],"Version":"2012-10-17"},"policyName":"ContainerImageBuildArm64e83729feb1564e709bec452b15847a30amd64RoleDefaultPolicy2316728F","roles":[{"Ref":"ContainerImageBuildArm64e83729feb1564e709bec452b15847a30amd64RoleC5F7BBFE"}]}}}}}}},"Resource":{"id":"Resource","path":"ContainerImageBuildIntegTest/ContainerImageBuildArm64e83729feb1564e709bec452b15847a30amd64/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_codebuild.CfnProject","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CodeBuild::Project","aws:cdk:cloudformation:props":{"artifacts":{"type":"NO_ARTIFACTS"},"cache":{"type":"NO_CACHE"},"encryptionKey":"alias/aws/s3","environment":{"type":"ARM_CONTAINER","image":"aws/codebuild/amazonlinux2-aarch64-standard:3.0","imagePullCredentialsType":"CODEBUILD","privilegedMode":true,"computeType":"BUILD_GENERAL1_SMALL"},"serviceRole":{"Fn::GetAtt":["ContainerImageBuildArm64e83729feb1564e709bec452b15847a30amd64RoleC5F7BBFE","Arn"]},"source":{"type":"NO_SOURCE","buildSpec":"{\n  \"version\": \"0.2\",\n  \"phases\": {\n    \"build\": {\n      \"commands\": [\n        \"current_dir=$(pwd)\",\n        \"echo \\\"$input\\\"\",\n        \"mkdir workdir\",\n        \"cd workdir\",\n        \"aws s3 cp \\\"$sourceS3Url\\\" temp.zip\",\n        \"unzip temp.zip\",\n        \"ls -la\",\n        \"aws ecr get-login-password --region $repositoryRegion | docker login --username AWS --password-stdin $repositoryAuthUri\",\n        \"aws ecr-public get-login-password --region us-east-1 | docker login --username AWS --password-stdin public.ecr.aws\",\n        \"docker buildx ls\",\n        \"echo \\\"$buildCommand\\\"\",\n        \"eval \\\"$buildCommand\\\"\",\n        \"docker images\",\n        \"docker tag artifact:$imageTag $repositoryUri:$imageTag\",\n        \"docker push $repositoryUri:$imageTag\"\n      ]\n    },\n    \"post_build\": {\n      \"commands\": [\n        \"echo Build completed on `date`\",\n        \"\\nSTATUS='SUCCESS'\\nif [ $CODEBUILD_BUILD_SUCCEEDING -ne 1 ] # Test if the build is failing\\nthen\\nSTATUS='FAILED'\\nREASON=\\\"ContainerImageBuild failed. See CloudWatch Log stream for the detailed reason: \\nhttps://$AWS_REGION.console.aws.amazon.com/cloudwatch/home?region=$AWS_REGION#logsV2:log-groups/log-group/\\\\$252Faws\\\\$252Fcodebuild\\\\$252F$projectName/log-events/$CODEBUILD_LOG_PATH\\\"\\nfi\\ncat <<EOF > payload.json\\n{\\n  \\\"StackId\\\": \\\"$stackId\\\",\\n  \\\"RequestId\\\": \\\"$requestId\\\",\\n  \\\"LogicalResourceId\\\":\\\"$logicalResourceId\\\",\\n  \\\"PhysicalResourceId\\\": \\\"$imageTag\\\",\\n  \\\"Status\\\": \\\"$STATUS\\\",\\n  \\\"Reason\\\": \\\"$REASON\\\",\\n  \\\"Data\\\": {\\n    \\\"ImageTag\\\": \\\"$imageTag\\\"\\n  }\\n}\\nEOF\\ncurl -i -X PUT -H 'Content-Type:' -d \\\"@payload.json\\\" \\\"$responseURL\\\"\\n              \"\n      ]\n    }\n  }\n}"}}}}}},"Function":{"id":"Function","path":"ContainerImageBuildIntegTest/Function","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.DockerImageFunction","version":"2.214.0","metadata":[{"code":"*"},{"code":"*"}]},"children":{"ServiceRole":{"id":"ServiceRole","path":"ContainerImageBuildIntegTest/Function/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.214.0","metadata":[{"assumedBy":{"principalAccount":"*","assumeRoleAction":"*"},"managedPolicies":[{"managedPolicyArn":"*"}]}]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"ContainerImageBuildIntegTest/Function/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.214.0","metadata":["*"]}},"Resource":{"id":"Resource","path":"ContainerImageBuildIntegTest/Function/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}}}},"Resource":{"id":"Resource","path":"ContainerImageBuildIntegTest/Function/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"imageUri":{"Fn::Join":["",[{"Fn::Select":[4,{"Fn::Split":[":",{"Fn::GetAtt":["BuildRepository4E6D17C2","Arn"]}]}]},".dkr.ecr.",{"Fn::Select":[3,{"Fn::Split":[":",{"Fn::GetAtt":["BuildRepository4E6D17C2","Arn"]}]}]},".",{"Ref":"AWS::URLSuffix"},"/",{"Ref":"BuildRepository4E6D17C2"},":",{"Fn::GetAtt":["Build45A36621","ImageTag"]}]]}},"packageType":"Image","role":{"Fn::GetAtt":["FunctionServiceRole675BB04A","Arn"]}}}},"LogGroup":{"id":"LogGroup","path":"ContainerImageBuildIntegTest/Function/LogGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogGroup","version":"2.214.0","metadata":[{"logGroupName":"*"}]},"children":{"Resource":{"id":"Resource","path":"ContainerImageBuildIntegTest/Function/LogGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnLogGroup","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::LogGroup","aws:cdk:cloudformation:props":{"logGroupName":{"Fn::Join":["",["/aws/lambda/",{"Ref":"Function76856677"}]]},"retentionInDays":731}}}}}}},"Cluster":{"id":"Cluster","path":"ContainerImageBuildIntegTest/Cluster","constructInfo":{"fqn":"aws-cdk-lib.aws_ecs.Cluster","version":"2.214.0","metadata":[{"vpc":"*"}]},"children":{"Resource":{"id":"Resource","path":"ContainerImageBuildIntegTest/Cluster/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ecs.CfnCluster","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ECS::Cluster","aws:cdk:cloudformation:props":{}}}}},"TaskDefinition":{"id":"TaskDefinition","path":"ContainerImageBuildIntegTest/TaskDefinition","constructInfo":{"fqn":"aws-cdk-lib.aws_ecs.FargateTaskDefinition","version":"2.214.0","metadata":["*","*","*","*","*"]},"children":{"TaskRole":{"id":"TaskRole","path":"ContainerImageBuildIntegTest/TaskDefinition/TaskRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.214.0","metadata":[{"assumedBy":{"principalAccount":"*","assumeRoleAction":"*"}}]},"children":{"ImportTaskRole":{"id":"ImportTaskRole","path":"ContainerImageBuildIntegTest/TaskDefinition/TaskRole/ImportTaskRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.214.0","metadata":["*"]}},"Resource":{"id":"Resource","path":"ContainerImageBuildIntegTest/TaskDefinition/TaskRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"ecs-tasks.amazonaws.com"}}],"Version":"2012-10-17"}}}}}},"Resource":{"id":"Resource","path":"ContainerImageBuildIntegTest/TaskDefinition/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ecs.CfnTaskDefinition","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ECS::TaskDefinition","aws:cdk:cloudformation:props":{"containerDefinitions":[{"essential":true,"image":{"Fn::Join":["",[{"Fn::Select":[4,{"Fn::Split":[":",{"Fn::GetAtt":["BuildRepository4E6D17C2","Arn"]}]}]},".dkr.ecr.",{"Fn::Select":[3,{"Fn::Split":[":",{"Fn::GetAtt":["BuildRepository4E6D17C2","Arn"]}]}]},".",{"Ref":"AWS::URLSuffix"},"/",{"Ref":"BuildRepository4E6D17C2"},":",{"Fn::GetAtt":["BuildArmF8ABF624","ImageTag"]}]]},"name":"main","logConfiguration":{"logDriver":"awslogs","options":{"awslogs-group":{"Ref":"TaskDefinitionmainLogGroup2F2AC027"},"awslogs-stream-prefix":"main","awslogs-region":{"Ref":"AWS::Region"}}}}],"cpu":"256","executionRoleArn":{"Fn::GetAtt":["TaskDefinitionExecutionRole8D61C2FB","Arn"]},"family":"ContainerImageBuildIntegTestTaskDefinition119492A3","memory":"512","networkMode":"awsvpc","requiresCompatibilities":["FARGATE"],"runtimePlatform":{"cpuArchitecture":"ARM64"},"taskRoleArn":{"Fn::GetAtt":["TaskDefinitionTaskRoleFD40A61D","Arn"]}}}},"main":{"id":"main","path":"ContainerImageBuildIntegTest/TaskDefinition/main","constructInfo":{"fqn":"aws-cdk-lib.aws_ecs.ContainerDefinition","version":"2.214.0"},"children":{"LogGroup":{"id":"LogGroup","path":"ContainerImageBuildIntegTest/TaskDefinition/main/LogGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogGroup","version":"2.214.0","metadata":[{"retention":"*"}]},"children":{"Resource":{"id":"Resource","path":"ContainerImageBuildIntegTest/TaskDefinition/main/LogGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnLogGroup","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::LogGroup","aws:cdk:cloudformation:props":{}}}}}}},"ExecutionRole":{"id":"ExecutionRole","path":"ContainerImageBuildIntegTest/TaskDefinition/ExecutionRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.214.0","metadata":[{"assumedBy":{"principalAccount":"*","assumeRoleAction":"*"},"roleName":"*"},{"addToPrincipalPolicy":[{}]},{"attachInlinePolicy":["*"]},{"attachInlinePolicy":["*"]},{"addToPrincipalPolicy":[{}]},{"addToPrincipalPolicy":[{}]}]},"children":{"ImportExecutionRole":{"id":"ImportExecutionRole","path":"ContainerImageBuildIntegTest/TaskDefinition/ExecutionRole/ImportExecutionRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.214.0","metadata":["*"]}},"Resource":{"id":"Resource","path":"ContainerImageBuildIntegTest/TaskDefinition/ExecutionRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"ecs-tasks.amazonaws.com"}}],"Version":"2012-10-17"}}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"ContainerImageBuildIntegTest/TaskDefinition/ExecutionRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.214.0","metadata":["*",{"attachToRole":["*"]},{"attachToRole":["*"]},{"addStatements":[{}]},{"addStatements":[{}]},{"addStatements":[{}]}]},"children":{"Resource":{"id":"Resource","path":"ContainerImageBuildIntegTest/TaskDefinition/ExecutionRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["ecr:BatchCheckLayerAvailability","ecr:BatchGetImage","ecr:GetDownloadUrlForLayer"],"Effect":"Allow","Resource":{"Fn::GetAtt":["BuildRepository4E6D17C2","Arn"]}},{"Action":"ecr:GetAuthorizationToken","Effect":"Allow","Resource":"*"},{"Action":["logs:CreateLogStream","logs:PutLogEvents"],"Effect":"Allow","Resource":{"Fn::GetAtt":["TaskDefinitionmainLogGroup2F2AC027","Arn"]}}],"Version":"2012-10-17"},"policyName":"TaskDefinitionExecutionRoleDefaultPolicy1F3406F5","roles":[{"Ref":"TaskDefinitionExecutionRole8D61C2FB"}]}}}}}}}}},"BuildVpc":{"id":"BuildVpc","path":"ContainerImageBuildIntegTest/BuildVpc","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"CustomResourceHandler":{"id":"CustomResourceHandler","path":"ContainerImageBuildIntegTest/BuildVpc/CustomResourceHandler","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.SingletonFunction","version":"2.214.0","metadata":[{"runtime":"*","code":"*","handler":"*","uuid":"*","lambdaPurpose":"*","timeout":"*"}]}},"Repository":{"id":"Repository","path":"ContainerImageBuildIntegTest/BuildVpc/Repository","constructInfo":{"fqn":"aws-cdk-lib.aws_ecr.Repository","version":"2.214.0","metadata":[{"removalPolicy":"destroy"}]},"children":{"Resource":{"id":"Resource","path":"ContainerImageBuildIntegTest/BuildVpc/Repository/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ecr.CfnRepository","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ECR::Repository","aws:cdk:cloudformation:props":{}}}}},"Project":{"id":"Project","path":"ContainerImageBuildIntegTest/BuildVpc/Project","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}},"Source":{"id":"Source","path":"ContainerImageBuildIntegTest/BuildVpc/Source","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.214.0"},"children":{"Stage":{"id":"Stage","path":"ContainerImageBuildIntegTest/BuildVpc/Source/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.214.0"}},"AssetBucket":{"id":"AssetBucket","path":"ContainerImageBuildIntegTest/BuildVpc/Source/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.214.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"ContainerImageBuildIntegTest/BuildVpc/Resource","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.214.0","metadata":["*","*","*"]},"children":{"Default":{"id":"Default","path":"ContainerImageBuildIntegTest/BuildVpc/Resource/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.214.0"}}}}}},"ContainerImageBuildAmd64e83729feb1564e709bec452b15847a30c8a085f75ccbc05f5149859bcf147b49eadd8ac37damd64":{"id":"ContainerImageBuildAmd64e83729feb1564e709bec452b15847a30c8a085f75ccbc05f5149859bcf147b49eadd8ac37damd64","path":"ContainerImageBuildIntegTest/ContainerImageBuildAmd64e83729feb1564e709bec452b15847a30c8a085f75ccbc05f5149859bcf147b49eadd8ac37damd64","constructInfo":{"fqn":"aws-cdk-lib.aws_codebuild.Project","version":"2.214.0","metadata":[{"environment":{"computeType":"BUILD_GENERAL1_SMALL","buildImage":{"type":"*","defaultComputeType":"BUILD_GENERAL1_SMALL","imageId":"*","imagePullPrincipalType":"CODEBUILD","secretsManagerCredentials":"*","repository":"*"},"privileged":true},"vpc":"*","buildSpec":"*"}]},"children":{"Role":{"id":"Role","path":"ContainerImageBuildIntegTest/ContainerImageBuildAmd64e83729feb1564e709bec452b15847a30c8a085f75ccbc05f5149859bcf147b49eadd8ac37damd64/Role","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.214.0","metadata":[{"roleName":"*","assumedBy":{"principalAccount":"*","assumeRoleAction":"*"}},{"addToPrincipalPolicy":[{}]},{"attachInlinePolicy":["*"]},{"attachInlinePolicy":["*"]},{"attachInlinePolicy":["*"]},{"attachInlinePolicy":["*"]},{"addToPrincipalPolicy":[{}]},{"addToPrincipalPolicy":[{}]},{"addManagedPolicy":[{"managedPolicyArn":"*"}]},{"addToPrincipalPolicy":[{}]},{"addToPrincipalPolicy":[{}]},{"addToPrincipalPolicy":[{}]},{"addToPrincipalPolicy":[{}]}]},"children":{"ImportRole":{"id":"ImportRole","path":"ContainerImageBuildIntegTest/ContainerImageBuildAmd64e83729feb1564e709bec452b15847a30c8a085f75ccbc05f5149859bcf147b49eadd8ac37damd64/Role/ImportRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.214.0","metadata":["*"]}},"Resource":{"id":"Resource","path":"ContainerImageBuildIntegTest/ContainerImageBuildAmd64e83729feb1564e709bec452b15847a30c8a085f75ccbc05f5149859bcf147b49eadd8ac37damd64/Role/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"codebuild.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/AmazonElasticContainerRegistryPublicReadOnly"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"ContainerImageBuildIntegTest/ContainerImageBuildAmd64e83729feb1564e709bec452b15847a30c8a085f75ccbc05f5149859bcf147b49eadd8ac37damd64/Role/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.214.0","metadata":["*",{"attachToRole":["*"]},{"attachToRole":["*"]},{"addStatements":[{}]},{"addStatements":[{}]},{"addStatements":[{}]},{"addStatements":[{}]},{"addStatements":[{}]},{"addStatements":[{}]},{"addStatements":[{}]}]},"children":{"Resource":{"id":"Resource","path":"ContainerImageBuildIntegTest/ContainerImageBuildAmd64e83729feb1564e709bec452b15847a30c8a085f75ccbc05f5149859bcf147b49eadd8ac37damd64/Role/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":"ec2:CreateNetworkInterfacePermission","Condition":{"StringEquals":{"ec2:Subnet":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":ec2:",{"Ref":"AWS::Region"},":",{"Ref":"AWS::AccountId"},":subnet/",{"Ref":"VpcV2PrivateSubnet1Subnet10A485FB"}]]},{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":ec2:",{"Ref":"AWS::Region"},":",{"Ref":"AWS::AccountId"},":subnet/",{"Ref":"VpcV2PrivateSubnet2Subnet038DDA50"}]]}],"ec2:AuthorizedService":"codebuild.amazonaws.com"}},"Effect":"Allow","Resource":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":ec2:",{"Ref":"AWS::Region"},":",{"Ref":"AWS::AccountId"},":network-interface/*"]]}},{"Action":["logs:CreateLogGroup","logs:CreateLogStream","logs:PutLogEvents"],"Effect":"Allow","Resource":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":logs:",{"Ref":"AWS::Region"},":",{"Ref":"AWS::AccountId"},":log-group:/aws/codebuild/",{"Ref":"ContainerImageBuildAmd64e83729feb1564e709bec452b15847a30c8a085f75ccbc05f5149859bcf147b49eadd8ac37damd64C6D1C187"},":*"]]},{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":logs:",{"Ref":"AWS::Region"},":",{"Ref":"AWS::AccountId"},":log-group:/aws/codebuild/",{"Ref":"ContainerImageBuildAmd64e83729feb1564e709bec452b15847a30c8a085f75ccbc05f5149859bcf147b49eadd8ac37damd64C6D1C187"}]]}]},{"Action":["codebuild:BatchPutCodeCoverages","codebuild:BatchPutTestCases","codebuild:CreateReport","codebuild:CreateReportGroup","codebuild:UpdateReport"],"Effect":"Allow","Resource":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":codebuild:",{"Ref":"AWS::Region"},":",{"Ref":"AWS::AccountId"},":report-group/",{"Ref":"ContainerImageBuildAmd64e83729feb1564e709bec452b15847a30c8a085f75ccbc05f5149859bcf147b49eadd8ac37damd64C6D1C187"},"-*"]]}},{"Action":["ecr:BatchCheckLayerAvailability","ecr:BatchGetImage","ecr:CompleteLayerUpload","ecr:DescribeImages","ecr:GetDownloadUrlForLayer","ecr:InitiateLayerUpload","ecr:PutImage","ecr:UploadLayerPart"],"Effect":"Allow","Resource":{"Fn::GetAtt":["BuildVpcRepositoryC4EB5D59","Arn"]}},{"Action":"ecr:GetAuthorizationToken","Effect":"Allow","Resource":"*"},{"Action":["s3:GetBucket*","s3:GetObject*","s3:List*"],"Effect":"Allow","Resource":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":s3:::",{"Fn::Sub":"cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"},"/*"]]},{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":s3:::",{"Fn::Sub":"cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"}]]}]}],"Version":"2012-10-17"},"policyName":"ContainerImageBuildAmd64e83729feb1564e709bec452b15847a30c8a085f75ccbc05f5149859bcf147b49eadd8ac37damd64RoleDefaultPolicyF7E07B6C","roles":[{"Ref":"ContainerImageBuildAmd64e83729feb1564e709bec452b15847a30c8a085f75ccbc05f5149859bcf147b49eadd8ac37damd64Role7FBDDED1"}]}}}}}}},"SecurityGroup":{"id":"SecurityGroup","path":"ContainerImageBuildIntegTest/ContainerImageBuildAmd64e83729feb1564e709bec452b15847a30c8a085f75ccbc05f5149859bcf147b49eadd8ac37damd64/SecurityGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.SecurityGroup","version":"2.214.0","metadata":[{"vpc":"*","description":"*","allowAllOutbound":"*"}]},"children":{"Resource":{"id":"Resource","path":"ContainerImageBuildIntegTest/ContainerImageBuildAmd64e83729feb1564e709bec452b15847a30c8a085f75ccbc05f5149859bcf147b49eadd8ac37damd64/SecurityGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroup","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroup","aws:cdk:cloudformation:props":{"groupDescription":"Automatic generated security group for CodeBuild ContainerImageBuildIntegTestContainerImageBuildAmd64e83729feb1564e709bec452b15847a30c8a085f75ccbc05f5149859bcf147b49eadd8ac37damd64A2A27E6C","securityGroupEgress":[{"cidrIp":"0.0.0.0/0","description":"Allow all outbound traffic by default","ipProtocol":"-1"}],"vpcId":{"Ref":"VpcV257066EE3"}}}}}},"Resource":{"id":"Resource","path":"ContainerImageBuildIntegTest/ContainerImageBuildAmd64e83729feb1564e709bec452b15847a30c8a085f75ccbc05f5149859bcf147b49eadd8ac37damd64/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_codebuild.CfnProject","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CodeBuild::Project","aws:cdk:cloudformation:props":{"artifacts":{"type":"NO_ARTIFACTS"},"cache":{"type":"NO_CACHE"},"encryptionKey":"alias/aws/s3","environment":{"type":"LINUX_CONTAINER","image":"aws/codebuild/standard:7.0","imagePullCredentialsType":"CODEBUILD","privilegedMode":true,"computeType":"BUILD_GENERAL1_SMALL"},"serviceRole":{"Fn::GetAtt":["ContainerImageBuildAmd64e83729feb1564e709bec452b15847a30c8a085f75ccbc05f5149859bcf147b49eadd8ac37damd64Role7FBDDED1","Arn"]},"source":{"type":"NO_SOURCE","buildSpec":"{\n  \"version\": \"0.2\",\n  \"phases\": {\n    \"build\": {\n      \"commands\": [\n        \"current_dir=$(pwd)\",\n        \"echo \\\"$input\\\"\",\n        \"mkdir workdir\",\n        \"cd workdir\",\n        \"aws s3 cp \\\"$sourceS3Url\\\" temp.zip\",\n        \"unzip temp.zip\",\n        \"ls -la\",\n        \"aws ecr get-login-password --region $repositoryRegion | docker login --username AWS --password-stdin $repositoryAuthUri\",\n        \"aws ecr-public get-login-password --region us-east-1 | docker login --username AWS --password-stdin public.ecr.aws\",\n        \"docker buildx ls\",\n        \"echo \\\"$buildCommand\\\"\",\n        \"eval \\\"$buildCommand\\\"\",\n        \"docker images\",\n        \"docker tag artifact:$imageTag $repositoryUri:$imageTag\",\n        \"docker push $repositoryUri:$imageTag\"\n      ]\n    },\n    \"post_build\": {\n      \"commands\": [\n        \"echo Build completed on `date`\",\n        \"\\nSTATUS='SUCCESS'\\nif [ $CODEBUILD_BUILD_SUCCEEDING -ne 1 ] # Test if the build is failing\\nthen\\nSTATUS='FAILED'\\nREASON=\\\"ContainerImageBuild failed. See CloudWatch Log stream for the detailed reason: \\nhttps://$AWS_REGION.console.aws.amazon.com/cloudwatch/home?region=$AWS_REGION#logsV2:log-groups/log-group/\\\\$252Faws\\\\$252Fcodebuild\\\\$252F$projectName/log-events/$CODEBUILD_LOG_PATH\\\"\\nfi\\ncat <<EOF > payload.json\\n{\\n  \\\"StackId\\\": \\\"$stackId\\\",\\n  \\\"RequestId\\\": \\\"$requestId\\\",\\n  \\\"LogicalResourceId\\\":\\\"$logicalResourceId\\\",\\n  \\\"PhysicalResourceId\\\": \\\"$imageTag\\\",\\n  \\\"Status\\\": \\\"$STATUS\\\",\\n  \\\"Reason\\\": \\\"$REASON\\\",\\n  \\\"Data\\\": {\\n    \\\"ImageTag\\\": \\\"$imageTag\\\"\\n  }\\n}\\nEOF\\ncurl -i -X PUT -H 'Content-Type:' -d \\\"@payload.json\\\" \\\"$responseURL\\\"\\n              \"\n      ]\n    }\n  }\n}"},"vpcConfig":{"vpcId":{"Ref":"VpcV257066EE3"},"subnets":[{"Ref":"VpcV2PrivateSubnet1Subnet10A485FB"},{"Ref":"VpcV2PrivateSubnet2Subnet038DDA50"}],"securityGroupIds":[{"Fn::GetAtt":["ContainerImageBuildAmd64e83729feb1564e709bec452b15847a30c8a085f75ccbc05f5149859bcf147b49eadd8ac37damd64SecurityGroup48FE16CC","GroupId"]}]}}}},"PolicyDocument":{"id":"PolicyDocument","path":"ContainerImageBuildIntegTest/ContainerImageBuildAmd64e83729feb1564e709bec452b15847a30c8a085f75ccbc05f5149859bcf147b49eadd8ac37damd64/PolicyDocument","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.214.0","metadata":[{"statements":"*"},{"addStatements":[{}]},{"attachToRole":["*"]},{"attachToRole":["*"]}]},"children":{"Resource":{"id":"Resource","path":"ContainerImageBuildIntegTest/ContainerImageBuildAmd64e83729feb1564e709bec452b15847a30c8a085f75ccbc05f5149859bcf147b49eadd8ac37damd64/PolicyDocument/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.214.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["ec2:CreateNetworkInterface","ec2:DeleteNetworkInterface","ec2:DescribeDhcpOptions","ec2:DescribeNetworkInterfaces","ec2:DescribeSecurityGroups","ec2:DescribeSubnets","ec2:DescribeVpcs"],"Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"},"policyName":"ContainerImageBuildAmd64e83729feb1564e709bec452b15847a30c8a085f75ccbc05f5149859bcf147b49eadd8ac37damd64PolicyDocument194E3D91","roles":[{"Ref":"ContainerImageBuildAmd64e83729feb1564e709bec452b15847a30c8a085f75ccbc05f5149859bcf147b49eadd8ac37damd64Role7FBDDED1"}]}}}}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"ContainerImageBuildIntegTest/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.214.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"ContainerImageBuildIntegTest/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.214.0"}}}},"Test":{"id":"Test","path":"Test","constructInfo":{"fqn":"@aws-cdk/integ-tests-alpha.IntegTest","version":"2.159.0-alpha.0"},"children":{"DefaultTest":{"id":"DefaultTest","path":"Test/DefaultTest","constructInfo":{"fqn":"@aws-cdk/integ-tests-alpha.IntegTestCase","version":"2.159.0-alpha.0"},"children":{"Default":{"id":"Default","path":"Test/DefaultTest/Default","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}},"DeployAssert":{"id":"DeployAssert","path":"Test/DefaultTest/DeployAssert","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.214.0"},"children":{"BootstrapVersion":{"id":"BootstrapVersion","path":"Test/DefaultTest/DeployAssert/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.214.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"Test/DefaultTest/DeployAssert/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.214.0"}}}}}}}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}}}}}